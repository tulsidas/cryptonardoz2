<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>#nardoz reloaded - introducción a la criptografía</title>

		<meta name="description" content="Introducción a la criptografía">
		<meta name="author" content="AndresQ">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/night.css" id="theme">
		<style type="text/css">
			.yellow { color: yellow; }
			.red { color: red; }
			.green { color: green; }
		</style>
	</head>

	<body>
		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>#nardoz reloaded</h1>
					<h2>introducción a la criptografía</h2>
				</section>

				<section>
					<h1>MD5 AES DES RC4 RSA XOR MAC SHA DHE DSA PKI SSL TLS</h1>
				</section>

				<section>
					<img src="img/nocomprende.jpg" height="600" />
				</section>

				<section>
					<h2>criptografía</h2>
					<p class="fragment yellow">confidencialidad</p>
					<p class="fragment yellow">integridad</p>
					<p class="fragment yellow">autenticación</p>
					<div class="fragment">
						<p><small>validación</small></p>
						<p><small>certificación</small></p>
						<p><small>no repudio</small></p>
						<p><small>timestamping</small></p>
						<p><small>etc...</small></p>
					</div>
				</section>

				<section>
					<h1>confidencialidad</h1>
					<img src="img/alicebob.png" />
				</section>

				<section>
					<h1>confidencialidad</h1>
					<pre><span class="red">c</span> = E<sub>k</sub>(<span class="green">m</span>)</pre>
					<pre><span class="green">m</span> = D<sub>k</sub>(<span class="red">c</span>)</pre>
					<pre class="fragment"><span class="green">m</span> = D<sub>k</sub>(E<sub>k</sub>(<span class="green">m</span>))</pre>
				</section>

				<section>
					<h2>Principio de Kerckhoffs</h2>
					<blockquote>
						Un sistema criptográfico debe ser seguro incluso si el atacante conoce todos los detalles del mismo, a excepción de la clave secreta.
					</blockquote>
				</section>

				<section>
					<h1>Historia</h1>
				</section>

				<section>
					<h2>Cifrado de César</h2>

					<p>alias ROT-3</p>

					<div class="fragment">
						<br/>
						<pre> a b c d e f g h i j k l m n o p q r s t u v w x y z </pre>
						<pre> D E F G H I J K L M N O P Q R S T U V W X Y Z A B C </pre>
					</div>

					<br/>
					<p class="fragment">ROT-N para 1 ≤ n ≤ 26</p>
				</section>

				<section>
					<h2>Sustitución monoalfabética</h2>
					<div class="fragment">
						<pre> a b c d e f g h i j k l m n o p q r s t u v w x y z </pre>
						<pre> R Q O A F C J T N E M Z U S D K V L Y X P G H W B I </pre>
					</div>
					<div class="fragment">
						<br/>
						<p>más fácil: frase o palabra clave + resto del alfabeto (opcionalmente rotado)</p>
						<pre> a b c d e f g h i j k l m n o p q r s t u v w x y z </pre>
						<pre><span class="green">M U R C I E L A G O</span> B D F H J K N P Q S T <span class="yellow">V W X Y Z</span></pre>
					</div>
					<p class="fragment">clave: permutación del alfabeto</p>
					<p class="fragment">tamaño de la clave: 26! ≈ 4×10<sup><small>26</small></sup> ≈ 2<sup><small>88</small></sup></p>
					<p class="fragment"><span class="red">fuerza bruta: muy difícil</span> (hoy)</p>
				</section>

				<section>
					<h2><em>side attack</em></h2>
					<p class="fragment">~1200 dc &mdash; frecuencias de letras (árabes)</p>
					<p class="fragment">análisis de frecuencias del texto cifrado</p>
					<p class="fragment"><img src="img/frecuencia.png" height="350" width="546"/></p>
					<p class="fragment"><strong>variantes</strong>: nulls, más de un símbolo por letra, símbolos especiales, etc...</p>
				</section>

				<section>
					<h2>Sustitución polialfabética</h2>
					<p class="fragment"><img src="img/vigenere.gif" height="300"/></p>
					<pre class="fragment"><span class="yellow">CRIPTO</span>CRIPTOCRIPTOCRIPTOCRIPTOCRIP</pre>
					<pre class="fragment">ayayayaycantaynollorescielitolindo</pre>
					<pre class="fragment"><span class="yellow">CP</span>INTM<span class="yellow">CP</span>KPGH<span class="yellow">CP</span>VDEZQIMHVWGCQIHZKELD</pre>
					<p class="fragment">¡chau frecuencias!</p>
					<p class="fragment"><em>le chiffre indéchiffrable</em></p>
				</section>

				<section>
					<h2>Vigènere</h2>
					<p class="fragment">Clave corta &rarr; se decripta fácil (Charles Babbage)</p>
					<p class="fragment">Clave larga &rarr; se decripta no tan fácil</p>
					<p class="fragment">¿Y si la clave es más larga?</p>
					<p class="fragment">¿Y si la clave es <strong>muy</strong> larga?</p>
					<p class="fragment">¿Y si la clave es <span style="font-size: 72px; color: #80A0C0">tan larga como el texto</span>?</p>
				</section>

				<section>
					<h1>one time pad</h1>
					<img class="fragment" src="img/HOLY-GRAIL.png" style="background: none; border: none"/>
					<pre class="fragment">cifrado = clave + texto (mod 26)</pre>
				</section>

				<section>
					<h2>one time pad</h2>
					<p style="color: #80A0C0">texto</p>
					<pre>elenemigoescobra</pre>
					<p style="color: #80A0C0">pad (clave)</p>
					<pre>UMLKLNGLEDFXYOOM</pre>
					<p style="color: #80A0C0">cifrado</p>
					<pre style="color: orange">YXPXPZORSHXZMPFM</pre>
					<br/>
					<p class="fragment">random + one time = <em class="yellow">perfect secrecy</em></p>
				</section>

				<section>
					<h2>one time pad</h2>
					<p>supongamos interceptamos el mensaje cifrado</p>
					<pre style="color: orange">YXPXPZORSHXZMPFM</pre>
					<p class="fragment">18 letras: 26<sup><small>18</small></sup> ≈ 3×10<sup><small>25</small></sup> ≈ 2<sup><small>85</small></sup> </p>
					<p class="fragment">pruebo todas las claves posibles</p>
					<p class="fragment"><strong><em>indescifrable incluso con poder computacional ilimitado</em></strong></p>
					<pre class="fragment">∀ x ∈ {a,z}<sup>n</sup> ∃ pad <em>k</em> ∈ {a,z}<sup>n</sup> / k ⊕ c = x </pre>
					<p class="fragment">o sea: puedo obtener <em>cualquier</em> texto</p>
				</section>

				<section>
					<h1>FIN</h1>
					<h3>¡Muchas gracias!</h3>
					<br/>
					<h2>¿ ?</h2>
					<p> Andres Quijano / <a href="http://twitter.com/quixote_arg">@quixote_arg</a> </p>
				</section>

				<section>
					<h1>¿FIN? ☹</h1>
					<p class="fragment">(verdaderamente) aleatorio = <span class="red">difícil</span></p>
					<p class="fragment">one-time = <span class="red">difícil</span></p>
					<p class="fragment">distribución de claves = <span class="red">difícil</span></p>
					<p class="fragment"><br/>en la práctica es poco usado</span></p>
				</section>

				<section>
					<h2>Stream ciphers</h2>
					<p>
						Dada <em>semilla</em> corta <code>k</code>, generar <strong class="yellow">keystream pseudoaleatorio</strong> (infinito) <code>ks</code> y luego hacer símil one time pad: <code>ks ⊕ m</code>
					</p>
					<pre class="fragment">k = password1234</pre>
					<pre class="fragment">ks(k) = 32672e912985ef5c598149f9c31666e1aa34cfae.....</pre>
					<p class="fragment"><br/>como <code>ks</code> es <em>pseudoaleatorio</em>, no hay perfect secrecy</p>
				</section>

				<section>
					<h2>Stream ciphers actuales</h2>
					<p>RC4, Salsa20, SOSEMANUK</p>
					<p>eStream (familia)</p>
				</section>

				<section>
					<h2>Block ciphers</h2>
					<div class="fragment">
						<p>encriptan de a bloques (tamaño fijo)</p>
						<img src="img/blockcipherencrypt.png" />
					</div>
				</section>

				<section>
					<h2>Block ciphers actuales</h2>
					<p>RC6, Twofish, Camellia, AES <span style="color: #FB930D">(rijndael)</span></p>
					<p><code>b = 128, k = 128 / 192 / 256</code></p>
				</section>

				<section>
					<h2>AES</h2>
					<img src="img/aes.png" />
				</section>

				<section>
					<h2>Block ciphers</h2>
					<p>modus operandi</p>
					<br/>
					<ul>
						<li>electronic codebook<code>(ECB)</code></li>
						<li>cipher block chaining<code>(CBC)</code></li>
						<li>output feedback<code>(OFB)</code></li>
						<li>cipher feedback<code>(CFB)</code></li>
						<li>counter<code>(CTR)</code></li>
						<li>Galois counter<code>(GCM)</code></li>
					</ul>
				</section>

				<section>
					<h2><code>ECB</code></h2>
					<img src="img/ECB.png" style="background-color: white"/>
					<div class="red"><em>por norma general, no usar</em></div>
				</section>

				<section>
					<h2><code>ECB</code></h2>
					<img src="img/Tux.jpg" class="fragment" />
					<img src="img/Tux_secure.jpg" class="fragment" />
					<img src="img/Tux_ecb.jpg" class="fragment" />
				</section>

				<section>
					<h2><code>CBC</code></h2>
					<img src="img/CBC.png" style="background-color: white"/>
				</section>

				<section>
					<h2><code>CTR</code></h2>
					<img src="img/CTR.png" style="background-color: white"/>
				</section>

				<section>
					<h2>distribución de claves = difícil</h2>
				</section>

				<section>
					<h2>Diffie-Hellman (1976)</h2>
					<img src="img/dh-paint.png" height="600" class="fragment" />
				</section>

				<section>
					<h2>Diffie-Hellman (1976)</h2>
					<pre>&alpha;, p conocidos</pre>
					<pre>Alice               Eve              Bob   </pre>
					<pre>a ∈ {1..p-1}                    b ∈ {1..p-1} </pre>
					<pre>A=&alpha;<sup>a</sup> mod p                      B=&alpha;<sup>b</sup> mod p</pre>
					<pre>           A &rarr;                &larr; B              </pre>
					<pre>k=B<sup>a</sup>=(&alpha;<sup>a</sup>)<sup>b</sup> = &alpha;<sup>ab</sup>                              </pre>
					<pre>                               k=A<sup>b</sup>=(&alpha;<sup>b</sup>)<sup>a</sup> = &alpha;<sup>ab</sup></pre>
					<pre>               ???               </pre>
				</section>

				<section>
					<h2>criptografía asimétrica</h2>
					<h3 class="fragment"><code>(
						<span class="green"> k<sub>pub</sub> </span>,
						<span class="red"> k<sub>pr</sub> </span>
						)</code>
					</h3>
					<p class="fragment"><img src="img/open_padlock.jpg" height="250px"/>&nbsp;&nbsp;&nbsp;<img src="img/key1.jpg" /></p>
					<pre class="fragment">D(<span class="green">k<sub>pub</sub></span>, E(<span class="green">k<sub>pub</sub></span>, m)) = <span class="fragment">💣</span></pre>
					<pre class="fragment">D(<span class="red">k<sub>pr</sub></span>, E(<span class="green">k<sub>pub</sub></span>, m)) = <span class="fragment">m</span></pre>
				</section>

				<section>
					<h2>criptografía asimétrica</h2>
					<p class="fragment">~1000x más lentos que algoritmos simétricos</p>
					<p class="fragment">necesitan claves más largas</p>
					<img class="fragment" src="img/pk-keys.png" />
					<p>
						<span class="fragment"><code class="yellow">RSA</code>: factorización de primos</span>
						<span class="fragment"><code class="yellow">DL</code>: logaritmo discreto</span>
						<span class="fragment"><code class="yellow">ECC</code>: curva elíptica</span>
					</p>
					<p class="fragment"><code>¿P=NP?</code> <span class="fragment">¡computadoras cuánticas!</span></p>
				</section>

				<section>
					<h2>criptografía asimétrica</h2>
					<p class="fragment"><br/><strong>Sistemas Híbridos</strong><br/>encriptación asimétrica <code>(RSA/ElGamal)</code> para intercambio de claves, simétrica <code>(AES)</code> para los mensajes</p>
				</section>

				<section>
					<h2>criptografía asimétrica</h2>
					<h3><code>(
						<span class="green"> k<sub>pub</sub> </span>,
						<span class="red"> k<sub>pr</sub> </span>
						)</code>
					</h3>
					<pre> D(<span class="red">k<sub>pr</sub></span>, E(<span class="green">k<sub>pub</sub></span>, m)) = m</pre>
					<p class="fragment"><br/>pero también...</p>
					<pre class="fragment">D(<span class="green">k<sub>pub</sub></span>, E(<span class="red">k<sub>pr</sub></span>, m)) = <span class="fragment">m</span></pre>
					<p class="fragment"><br/><em>firma digital</em></p>
				</section>

				<section>
					<img src="img/tls.png" />
					<p class="fragment">AES_128_GCM: AES, k=128 bits, Galois Counter Mode</p>
					<p class="fragment">ECDHE_RSA = Elliptic Curve Diffie-Hellman Exchange, (firmado con) RSA</p>
				</section>

				<section>
					<h1>integridad</h1>
					<p class="fragment">no me toqueteen mi mensaje</p>
				</section>

				<section>
					<h2>hashes criptográficos</h2>
					<p class="fragment"><code>H: {0,1}<sup>n</sup> &rarr; {0,1}<sup>m</sup><br/>n: cualquier valor, m: fijo</code></p>
				</section>

				<section>
					<h2>hashes criptográficos</h2>
					<br/>
					<pre class="fragment"><code>h("")             = d41d8cd98f00b204e9800998ecf8427e</code></pre>
					<pre class="fragment"><code>h("hola pianola") = ba5ba94503a131c30b74b38ed79f8ca7</code></pre>
					<pre class="fragment"><code>h("hola pianol<span class="yellow">o</span>") = b7cddeb1e96f4849abd0c2f85be3e842</code></pre>
					<pre class="fragment"><code>h(&lt;archivo 5 GB&gt;) = xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</code></pre>
					<br/>
					<p class="fragment"><code>H(m) = h</code></p>
					<p class="fragment">Hallar <code>m</code> tal que <code>H(m) = d2419fa03f565dc7f8b31ed0539d151c</code></p>
					<p class="fragment">💣</p>
				</section>

				<section>
					<h2>hashes criptográficos</h2>
					<p class="fragment red">MD4 / MD5 (128 bits)</p>
					<p class="fragment" style="color: orange">SHA-1 (160 bits)</p>
					<p class="fragment green">SHA-2 (224 / 256 / 384 / 512)</p>
					<p class="fragment"><span class="green">SHA-3 (224 / 256 / 384 / 512) </span><br/><small>keccak / RadioGatún</small></p>
				</section>

				<section>
					<h1>autenticación</h1>
					<img src="img/sandra.jpg" />
				</section>

				<section>
					<h2>Message Authentication Code (MAC)</h2>
					<p class="fragment">hash criptográfico <span class="yellow">con clave</span></p>
					<p class="fragment">proveen <strong class="yellow">integridad y autenticación</strong> a un mensaje</p>
					<p class="fragment">es computacionalmente imposible modificar el mensaje y también el MAC</p>
				</section>

				<section>
					<h2>HMAC</h2>
					<p class="fragment">basado en hashes criptográficos</p>
					<p class="fragment">HMAC(k, m) = h(k ⊕ opad || h(k ⊕ ipad || m)</p>
					<img class="fragment" src="img/hmac.jpg" height="500" />
				</section>

				<section>
					<h2>Otros tipos de MAC</h2>
					<br/>
					<div class="fragment">
						<p>OMAC</p>
						<p>CBC-MAC</p>
						<p>PMAC</p>
						<p><br/>basados en block ciphers</p>
					</div>
				</section>

				<section>
					<h2>Tengo el MAC, ¿y ahora?</h2>
					<div class="fragment">
						<p>encrypt-and-mac</p>
						<p>E<sub>k</sub>(m) || MAC<sub>k</sub>(m)</p>
						<p class="fragment red">MAC puede filtrar info de <code>m</code></p>
					</div>
					<div class="fragment">
						<hr/>
						<p>mac-then-encrypt</p>
						<p>E<sub>k</sub>(m || MAC<sub>k</sub>(m))</p>
						<p class="fragment" style="color: orange;">puede fallar</p>
					</div>
					<div class="fragment">
						<hr/>
						<p>encrypt-then-mac</p>
						<p>E<sub>k</sub>(m) || MAC<sub>k</sub>(E<sub>k</sub>(m))</p>
						<p class="fragment green">siempre correcto</p>
					</div>
				</section>

				<section>
					<h2>Caso práctico #1</h2>
					<p>guardar passwords en la DB</p>
					<div class="fragment">
						<p><br/>hay que asumir el hacker (o topo) podría tener acceso a <em>TODO</em>:</p>
						<p>db, código, filesystem, ...</p>
					</div>
				</section>

				<section>
					<h2>Caso práctico #1</h2>
					<p>guardar passwords en la DB</p>
					<br/>
					<p class="fragment">
						ROT-26
						<span class="fragment red">horrible</span>
					</p>
					<p class="fragment">
						encriptado con algo simétrico
						<span class="fragment red">no suma si tienen el código</span>
					</p>
					<p class="fragment">
						encriptado con algo asimétrico
						<span class="fragment red">no suma si tienen el código</span>
					</p>
					<p class="fragment">
						hash
						<span class="fragment red">fácil con rainbow tables</span>
					</p>
					<p class="fragment">
						hash + salt único
						<span class="fragment red">fácil con mucho CPU</span>
					</p>
					<p class="fragment">
						hash + salt por registro
						<span class="fragment" style="color: orange;">difícil, con mucho CPU</span>
					</p>
					<p class="fragment">
						multihash + salt por registro
						<span class="fragment green">muy difícil</span>
					</p>
					<p class="fragment">
						bcrypt, scrypt
						<span class="fragment green">muy difícil</span>
					</p>
				</section>

				<section>
					<h2>Caso práctico #2</h2>
					<p>Ocultar datos en una URL</p>
					<br/>
					<p class="fragment"><code>www.pepe.com/view?id=<span class="yellow">123</span></code></p>
					<p class="fragment"><strong class="red">no reemplaza a control de accesos en el server</strong></p>
					<p class="fragment">
						ofuscación sencilla (ROT-13, base64, etc.)
					</p>
					<p class="fragment">
						hash simple (<em>pseudo firma</em>)
						&rarr; 
						<code>view?id=<span class="yellow">123&amp;sig=<em>h(123)</em></span></code>
					</p>
					<p class="fragment">
						hash complejo (con salt)
						&rarr;
						<strong class="red">¡ojo!</strong> se expone <code>m</code> y <code>h(m)</code>
					</p>
					<p class="fragment">
						algoritmo simétrico
						&rarr;
						<code>view?id=<span class="yellow"><em>E(123)</em></span></code>
					</p>
				</section>

				<section>
					<h2>Caso práctico #3</h2>
					<p>password manager fatto in casa</p>
					<br/>
					<p class="fragment">memorizo clave fácil: <code>pirulo</code></p>
					<p class="fragment"><code>clave = h(pirulo || dominio)</code></p>
					<p class="fragment"><strong>h</strong> determina el tamaño de la clave</p>
					<p class="fragment">
						<code>echo -n &lt;texto&gt; | (md5sum|sha1sum|sha256sum)</code>
					</p>
					<p class="fragment">
						<code>md5(pirulo+amazon.com)= 00edb49595b6f1c8cf35375c861ea6c3</code>
					</p>
				</section>

				<section>
					<img src="img/etpa.jpg" />
					<p>Si aún queda tiempo, pasa a la siguiente página</p>
					<p>Si te quedaste sin tiempo, huye antes que te tiren tomates</p>
					<p class="fragment">(risas)</p>
				</section>

				<section>
					<h2>one-time passwords</h2>
					<h4 class="fragment"><em>&quot;towards strong authentication&quot;</em></h4>
					<p class="fragment">no confundir con <em style="color: cyan">one time pad</em></p>
					<br/>
					<p class="fragment">claves estáticas = replay attack</p>
					<p class="fragment">OTP: challenge &rarr; response</p>
					<p class="fragment">sirven para <em>una</em> sesión</p>
					<p class="fragment">no importa si alguien me pispea la clave</p>
				</section>

				<section>
					<h2>one-time passwords</h2>
					<p class="fragment">server y cliente comparten una clave privada <code style="color: orange">k</code></p>
					<p class="fragment"><strong>HOPT</strong> &mdash; HMAC-based One-Time Password</p>
					<p class="fragment"><em>counter based</em></p>
					<p class="fragment">el challenge, groso modo: </p>
					<p class="fragment">encriptá el contador <code style="color: orange">c</code> con la clave <code style="color: orange">k</code> y decime cuánto te dio</p>
					<p class="fragment">si los valores coinciden, el usuario es auténtico</p>
					<br/>
					<p class="fragment"><code>HOTP(k,c) = truncate(HMAC(k,c)) &amp; 0x7FFFFFFF</code></p>
				</section>

				<section>
					<h2>one-time passwords</h2>
					<p class="fragment"><strong>TOPT</strong> &mdash; Time-based One-Time Password</p>
					<p class="fragment"><em>time based</em></p>
					<p class="fragment">el challenge, groso modo: </p>
					<p class="fragment">encriptá la hora actual <code style="color: orange">t</code> con la clave <code style="color: orange">k</code> y decime cuánto te dio</p>
					<p class="fragment">si los valores coinciden, el usuario es auténtico</p>
					<br/>
					<p class="fragment"><code>TOTP(k) = HOTP(k, <em>f</em>(ts))</code></p>
					<p class="fragment"><code>f=</code> intervalos de 30 segundos, y ventanas de changüí</p>
				</section>

				<section>
					<img src="img/securid.gif" align="center" />
					<img src="img/googleauth.png" height="600" />
				</section>

				<section>
					<h1>FIN</h1>
					<small>ahora si</small>
					<h3>¡Muchas gracias!</h3>
					<br/>
					<h2>¿ ?</h2>
					<p> Andres Quijano / <a href="http://twitter.com/quixote_arg">@quixote_arg</a> </p>
				</section>
			</div>
		</div>

		<script src="js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>
			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: false,
				history: true,
				center: true,

				theme: "night",
				transition: "linear"
			});
		</script>
	</body>
</html>
